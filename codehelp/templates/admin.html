{% extends "base.html" %}
{% from "tables.html" import datatable %}

{% block body %}
<section class="section">
  <div class="columns is-desktop">
    <div class="column is-5">
      <h1 class="is-size-3">Users</h1>
      {{ datatable('users', [('id', 'id'), ('username', 'username'), ('lti_id', 'lti_id'), ('#queries', 'num_queries')], users, link_col=1, link_template="?username=${value}") }}
      <h1 class="is-size-3">Roles</h1>
      {{ datatable('roles', [('id', 'id'), ('username', 'username'), ('lti_context', 'lti_context'), ('role', 'role'), ('#queries', 'num_queries')], roles, link_col=0, link_template="?role=${value}") }}
    </div>
    <div class="column is-7">
      <h1 class="is-size-3">
        Queries
      <div class="tags is-inline are-medium">
        {% if username %}
        <span class="tag is-info mb-0">
          user={{username}}
          <a class="delete is-small is-link" href="?"></a>
        </span>
        {% endif %}
        {% if role %}
        <span class="tag is-info mb-0">
          role={{role}}
          <a class="delete is-small is-link" href="?"></a>
        </span>
        {% endif %}
      </div>
      </h1>
      {{ datatable('queries', [('id', 'id'), ('user', 'username'), ('role', 'role_id'), ('time', 'query_time'), ('language', 'language'), ('code', 'code'), ('error', 'error'), ('issue', 'issue'), ('response', 'response_text')], queries, link_col=0, link_template="/help/${value}") }}
    </div>
  </div>
</section>
{% endblock %}
